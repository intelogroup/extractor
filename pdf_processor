import pdfplumber
import google.generativeai as genai
from typing import Dict, Optional

def process_pdf(file) -> Optional[Dict[str, str]]:
    try:
        with pdfplumber.open(file) as pdf:
            text = ""
            for page in pdf.pages[:2]:  # First two pages
                text += page.extract_text() + "\n"
                
        model = genai.GenerativeModel('gemini-pro')
        prompt = """Extract and return these fields as JSON:
        - title
        - authors (as list)
        - year
        - journal
        - doi
        - abstract
        
        Text: {text}
        """
        
        response = model.generate_content(prompt.format(text=text))
        return response.text
        
    except Exception as e:
        print(f"Error processing PDF: {e}")
        return None
